<div class="d-flex justify-content-center align-self-center mt-2">
  <h2 style="font-weight: bold;">View Order Details </h2>

</div>



<div class="p1dv1 col-11 ">

  <button class="btn btn-success" type="button" data-toggle="collapse" data-target="#collapseBox1"
  aria-expanded="false" aria-controls="collapseBox1">
  Collapse/Expand 
  </button>

  <div class="collapse   "   id="collapseBox1">

  <div class="row  mt-1" >

    <div class=" col-md-1 col-sm-4 d-flex  align-items-center">
      <label class="inputLable">Email</label>
    </div>
    <div class=" col-md-3 col-sm-8 d-flex  align-items-center">
      <input type="text" disabled="true" maxlength="99" [(ngModel)]="email" style="background-color: white;"
        class="form-control" name="productName2" id="productName2">

    </div>
    <div class=" col-md-1 col-sm-4  d-flex  align-items-center">
      <label class="inputLable">OTP</label>
    </div>
    <div class=" col-md-3 col-sm-8 d-flex  align-items-center">
      <input type="text" maxlength="11" [(ngModel)]="otp" style="background-color: white;" class="form-control"
        name="productName2" id="productName2">
    </div>
    <div class=" col-md-2 col-sm-6 d-flex justify-content-end">
      <button class="btn btn-primary mt-2  ml-3 " style="font-size: 20px;" mat-icon-button color="success"
        (click)="generateOTP()">
        Generate OTP
      </button>
    </div>
    <div class=" col-md-2 col-sm-6 d-flex justify-content-end">
      <button class="btn btn-success  mt-2 ml-3 " style="font-size: 20px;" mat-icon-button color="success"
        (click)="generateOTP()">
        REFRESH
      </button>
    </div>

  </div>


  <div class="row mt-3 "  >
   
    <div class=" col-md-3 col-sm-6">

      <div class="form-group " style="background-color: lawngreen;">
        <p style="font-weight: bold;font-size: 20px;margin-left:10px;padding-top:5px;padding-bottom: 5px;"> Agreed </p>
      </div>
    </div>
    <div class="  col-md-3 col-sm-6">
      <div class="form-group " style="background-color: Yellow;">
        <p style="font-weight: bold;font-size: 20px;margin-left:10px;padding-top:5px;padding-bottom: 5px;"> Pending / Insufficent quantity </p>
      </div>
    </div>
    <div class="  col-md-3 col-sm-6">
      <div class="form-group " style="background-color: red;">
        <p style="font-weight: bold;font-size: 20px;margin-left:10px;padding-top:5px;padding-bottom: 5px;"> Not Available </p>
      </div>
    </div>
    <div class="  col-md-3 col-sm-6" >
      <div class="form-group " style="background-color: CornflowerBlue;">
        <p style="font-weight: bold;font-size: 20px;margin-left:10px;padding-top:5px;padding-bottom: 5px;"> Substitude </p>
      </div>
      
    </div>

</div>


</div>

  <ul class="nav nav-fill nav-tabs mt-3" role="tablist" style="background-color: lightgray;height: 42px;">
    <li class="nav-item" role="presentation">
      <a class="nav-link active" id="fill-tab-0" data-bs-toggle="tab" href="#fill-tabpanel-0"
        style="font-size: 25px;font-weight: bold;" role="tab" aria-controls="fill-tabpanel-0" aria-selected="true">
        Summary </a>
    </li>
    <li class="nav-item" role="presentation">
      <a class="nav-link" id="fill-tab-1" data-bs-toggle="tab" href="#fill-tabpanel-1"
        style="font-size: 24px;font-weight: bold;" role="tab" aria-controls="fill-tabpanel-1" aria-selected="false">
        Items </a>
    </li>
    <li class="nav-item" role="presentation">
      <a class="nav-link" id="fill-tab-2" data-bs-toggle="tab" href="#fill-tabpanel-2"
        style="font-size: 20px;font-weight: bold;" role="tab" aria-controls="fill-tabpanel-2" aria-selected="false"
        [ngStyle]="{'background-color': (getInterimOrderTotal() > 0) ? 'yellow'  : 'none'}"> Actions </a>
    </li>
    <li class="nav-item" role="presentation">
      <a class="nav-link" id="fill-tab-3" data-bs-toggle="tab" href="#fill-tabpanel-3"
        style="font-size: 18px;font-weight: bold;" role="tab" aria-controls="fill-tabpanel-3" aria-selected="false"
        [(ngModel)]="unReadMessages"  [ngStyle]=" this.unReadMessages > 0 ? {'background-color':'yellow'} : {'background-color':'lightgray'}"> Messages   ( {{getNonReadMessages()}}) </a>
    </li>
    <!--{'background-color': getNonReadMessages() > 0 ? 'yellow'  : 'transparent'} always needs to write in json way-->
  </ul>



  <div class="tab-content pt-4" id="tab-content">
    <div class="tab-pane active" id="fill-tabpanel-0" role="tabpanel" aria-labelledby="fill-tab-0">




      <app-order-summery-comman class="mt-3"></app-order-summery-comman>



    </div>
    <div class="tab-pane" id="fill-tabpanel-1" role="tabpanel" aria-labelledby="fill-tab-1">


      <h1 class="mt-2"> AGREED ORDER ITEMS & APPROVAL PENDING SUGGESTIONS</h1>
      <h1 class="mt-2 d-none d-lg-block" *ngIf="isThereSuggesstions()"> There are shop owner suggestions for the unavailable items, you need to take actions using next
        tab to them</h1>

      <div class="mt-3">
        <div class="mt-1 table-responsive " *ngIf="isThereSuggesstions()">
          <table mat-table [dataSource]="interimStockDetailsList2" class="mat-elevation-z8 overflow-auto">

            <!--- Note that these columns can be defined in any order.
                                  The actual rendered columns are set as a property on the row definition" -->

            <!-- Position Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef> Name </th>
              <td mat-cell *matCellDef="let element"> {{element.productName}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="amount">
              <th mat-header-cell *matHeaderCellDef> Item Price </th>
              <td mat-cell *matCellDef="let element"> {{element.itemPrice}} </td>
            </ng-container>

            <!-- Weight Column -->
            <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef> Quantity </th>
              <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
            </ng-container>


            <!--
            <ng-container matColumnDef="status" >
              <th mat-header-cell *matHeaderCellDef> status </th>
              <td mat-cell *matCellDef="let element"> {{element.itemStatus}}</td>
            </ng-container>
            -->
            <!-- Symbol Column -->
            <ng-container matColumnDef="total">
              <th mat-header-cell *matHeaderCellDef style="text-align: center;"> Total </th>
              <td mat-cell *matCellDef="let element" style="text-align: center;">
                {{calculateInterimRowTotal(element.quantity,element.itemPrice)}} </td>
            </ng-container>





            <tr mat-header-row *matHeaderRowDef="displayedColumnsInterim2"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsInterim2;"></tr>
          </table>

          <table class="table">
            <thead class="thead">
              <tr>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr>
                <td></td>
                <td></td>
                <td></td>
                <td style="text-align: right;font-weight: bold;">Pending Items Total : {{getInterimOrderTotal()}}</td>
              </tr>
            </tbody>



          </table>

          <mat-paginator [pageSizeOptions]="[5]" #paginatorInterimOrderItems2="matPaginator" showFirstLastButtons
            aria-label="Select page of periodic elements">
          </mat-paginator>
        </div>
        <!--[ordrDt3]="ordrDt" -->

        <app-order-details-comman class="mt-3"></app-order-details-comman>


      </div>




    </div>
    <div class="tab-pane" id="fill-tabpanel-2" role="tabpanel" aria-labelledby="fill-tab-2">

      <h1 class="mt-2" >TAKE ACTIONS FOR THE SHOP OWNER SUGGESTIONS </h1>
      <div class="mt-3 table-responsive">

        <table mat-table [dataSource]="interimStockDetailsList1" class="mat-elevation-z8  overflow-auto">

          <!--- Note that these columns can be defined in any order.
                              The actual rendered columns are set as a property on the row definition" -->

          <!-- Position Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef style="text-align: start;"> Name </th>
            <td mat-cell *matCellDef="let element" style="text-align: start;"> {{element.productName}} </td>
          </ng-container>

          <!-- Name Column -->
          <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef> Price </th>
            <td mat-cell *matCellDef="let element"> {{element.itemPrice}} NZD</td>
          </ng-container>

          <!-- Weight Column -->
          <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef > _Q_ </th>
            <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
          </ng-container>

          <ng-container matColumnDef="need">
            <th mat-header-cell *matHeaderCellDef> _N_</th>
            <td mat-cell *matCellDef="let element">

              <select [(ngModel)]="element.needQuantity">
                <option *ngFor="let item of [].constructor(element.quantity); index as i" value="{{i+1}}">
                  {{i + 1}}
                </option>
              </select>

            </td>
          </ng-container>
          <!--
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef> status </th>
            <td mat-cell *matCellDef="let element"> {{element.itemStatus}}</td>
          </ng-container>
          -->
          <!-- Symbol Column -->
          <ng-container matColumnDef="total">
            <th mat-header-cell *matHeaderCellDef style="text-align: center;"> Total </th>
            <td mat-cell *matCellDef="let element" style="text-align: center;">
              {{calculateInterimRowTotal(element.needQuantity,element.itemPrice)}} NZD</td>
          </ng-container>


          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef style="text-align: right;"> Actions </th>
            <td mat-cell *matCellDef="let element" style="text-align: right;">
              <button mat-icon-button class="btn btn-danger btn-sm mt-1" (click)="reject(element.id)"> Reject</button>
              <button mat-icon-button class="btn btn-success btn-sm ml-1 mt-1" (click)="approve(element.id,element)"> Approve</button>
            </td>
          </ng-container>


          <tr mat-header-row *matHeaderRowDef="displayedColumnsInterim1"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnsInterim1;"></tr>
        </table>

        <table class="table">
          <thead class="thead">
            <tr>

            </tr>

          </thead>

          <tbody class="tbody">
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <!--<td style="text-align: right;font-weight: bold;">Order Total : {{getInterimOrderTotal()}}</td>-->
            </tr>
          </tbody>



        </table>

        <mat-paginator [pageSizeOptions]="[5]" #paginatorInterimOrderItems1="matPaginator" showFirstLastButtons
          aria-label="Select page of periodic elements">
        </mat-paginator>


      </div>





    </div>
    <!--style="background-color: springgreen;text-align:center; padding-top:50px;   height: 250px;font-size: 27px; "-->
    <div class="tab-pane " id="fill-tabpanel-3" role="tabpanel" aria-labelledby="fill-tab-3">
      <h1 class="mt-2">SEND AND VIEW MESSAGES FROM HERE</h1>

      <div class="row mt-2">


        <div class="form-group  col-md-8 col-sm-12">
          <!--<input type="text"   [(ngModel)]="message" class="form-control" id="description" placeholder="type message">-->
          <textarea class="form-control" placeholder="type the message here" id="w3review" name="w3review"
            maxlength="250" rows="2" [(ngModel)]="message"></textarea>
        </div>

        <div class="form-group col-md-2 col-sm-6 d-flex justify-content-end align-self-center">

          <button class="btn btn-primary btn-sm ml-3 " style="font-size: 20px;" mat-icon-button color="primary"
            (click)="sendMessage()">
            Send Msg
          </button>
        </div>

        <div class="form-group col-md-2 col-sm-6   d-flex justify-content-end align-self-center">

          <button class="btn btn-success  ml-3 " style="font-size: 20px;" mat-icon-button color="success"
            (click)="refresh()">
            Refresh
          </button>
        </div>


      </div>

      <h1 class="mt-3">View Latest 20 Messages</h1>

      <div class="mt-2">

        <div class="container" *ngFor="let m of messageSlice">
          <div class="row mb-3" style="background-color: white;"
            [ngStyle]="{'background-color': (m.readByCustomer == 'NO') ? 'yellow' : (m.email != email) ? 'CornflowerBlue' : 'white'}">
            <div class="     col-lg-2 col-md-4 d-flex justify-content-start align-items-center">
              <p style="font-size: 16px;">{{m.createdDate | date:'short'}}</p>
            </div>
            <div class=" col-lg-6 col-md-8 d-flex justify-content-start align-items-center">
              <p style="font-size: 16px;">MESSAGE : {{m.readByCustomer == 'YES' ? m.message : 'CLICK VIEW BUTTON'}}</p>
            </div>
            <div class=" col-lg-2 col-md-6 d-flex justify-content-end align-items-center">
              <p *ngIf="m.email == email" style="font-size: 16px;font-weight: bold;">Read By Shop : {{m.readByShop}}</p>
            </div>
            <div class=" col-lg-2 col-md-6 d-flex justify-content-end align-items-center mb-2"> <button
                *ngIf="m.readByCustomer == 'NO'" class="btn btn-primary mt-2 " (click)="viewMessage(m.id)">
                VIEW</button> <button *ngIf="m.readByCustomer == 'YES'" class="btn btn-primary mt-2 mr-2 "
                (click)="viewMessagePopup(m.message)"> View</button> <button *ngIf="m.email == email && m.id != 0"
                class="btn btn-danger mt-2 "> Delete</button> </div>
          </div>
        </div>

        <mat-paginator class="mt-3 mb-3 " #paginatorMessages="matPaginator" [length]="Msglnght" [pageSize]="5"
          [pageSizeOptions]="[5]" (page)="onPageChange($event)" aria-label="Select page">
        </mat-paginator>

      </div>

    </div>
  </div>








</div>